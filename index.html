<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text â†” PDF Converter â€¢ Yasmer PDF</title>
  <meta name="description" content="TXT â†’ PDF and PDF â†’ TXT conversion. Upload your file and download instantly. Free.">
  <style>
    :root{
      --bg:#0a0b0f; --card:#0f1117; --muted:#a6b0c3; --text:#e6e9ef;
      --acc1:#00d084; --acc2:#2dd4bf;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font:16px/1.6 system-ui,Segoe UI,Inter,Arial; color:var(--text);
      background: radial-gradient(1200px 600px at 20% 0%, rgba(0,208,132,.09), transparent 40%),
                  radial-gradient(1000px 600px at 90% 10%, rgba(45,212,191,.08), transparent 35%),
                  var(--bg);
      display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .shell{width:100%; max-width:980px}
    header{display:flex; align-items:center; justify-content:space-between; margin-bottom:24px}
    .logo{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px}
    .logo span{background:linear-gradient(90deg,var(--acc1),var(--acc2)); -webkit-background-clip:text; color:transparent}
    .flags{display:flex; gap:10px}
    .flag{cursor:pointer; font-size:24px; line-height:1; filter:grayscale(60%);}
    .flag.active{filter:none; transform:scale(1.05);}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px; padding:22px; box-shadow:0 10px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(8px);
    }
    .grid{display:grid; grid-template-columns:1.2fr .8fr; gap:18px}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} }
    h1{margin:8px 0 6px; font-size:28px}
    p.sub{margin:0 0 16px; color:var(--muted)}
    textarea{
      width:100%; min-height:300px; padding:14px; border-radius:12px;
      border:1px solid rgba(255,255,255,.1); background:#0c0e13; color:var(--text);
      outline:none; box-shadow: inset 0 0 0 1px rgba(0,0,0,.2);
    }
    .actions{display:flex; gap:10px; margin-top:12px; flex-wrap:wrap}
    button, .ghost{
      border:0; border-radius:12px; padding:12px 16px; font-weight:700; cursor:pointer;
    }
    .primary{background:linear-gradient(90deg,var(--acc1),var(--acc2)); color:#072315}
    .ghost{background:transparent; color:var(--text); border:1px dashed rgba(255,255,255,.25)}
    .side{display:flex; flex-direction:column; gap:14px;}
    .panel{
      border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:14px; background:#0c0e13;
    }
    .panel label{display:block; font-size:14px; color:var(--muted); margin-bottom:6px}
    select, input[type="text"]{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.15); background:#0b0d12; color:var(--text);
    }
    .drop{
      border:1.5px dashed rgba(255,255,255,.25); border-radius:12px; padding:18px; text-align:center;
      background:rgba(255,255,255,.02);
    }
    .drop.drag{border-color:var(--acc1); background:rgba(0,208,132,.06)}
    .muted{color:var(--muted); font-size:14px}
    footer{margin-top:14px; color:var(--muted); font-size:13px; text-align:center}
    .badge{display:inline-block; padding:2px 10px; border-radius:999px; font-weight:700; font-size:12px; background:rgba(0,208,132,.12); color:#8bf0c8; border:1px solid rgba(0,208,132,.3)}
  </style>
</head>
<body>
  <div class="shell">
    <header>
      <div class="logo"><strong>Yasmer <span>PDF</span></strong></div>
      <div class="flags">
        <div id="flag-en" class="flag active" title="English">ðŸ‡¬ðŸ‡§</div>
        <div id="flag-tr" class="flag" title="TÃ¼rkÃ§e">ðŸ‡¹ðŸ‡·</div>
      </div>
    </header>

    <div class="card">
      <div class="grid">
        <!-- Left -->
        <div>
          <h1 id="title">TXT â†’ PDF</h1>
          <p class="sub" id="subtitle">Type/paste text or drop a .txt file in the box on the right.</p>

          <form id="f">
            <textarea name="text" id="text" placeholder="Type your text here..."></textarea>
            <div class="actions">
              <button class="primary" type="submit" id="actionBtn">Create & Download PDF</button>
              <button class="ghost" type="button" id="clearBtn">Clear</button>
            </div>
          </form>

          <p class="muted" id="hint">In PDF â†’ TXT mode, the extracted text appears here and downloads as .txt.</p>
        </div>

        <!-- Right -->
        <div class="side">
          <div class="panel">
            <label for="mode" id="modeLabel">Conversion Mode</label>
            <select id="mode">
              <option value="txt2pdf">TXT â†’ PDF</option>
              <option value="pdf2txt">PDF â†’ TXT</option>
            </select>
          </div>

          <div class="panel">
            <label id="uploadLabel">Upload (Drag & Drop)</label>
            <div id="drop" class="drop">
              <strong id="acceptLabel">.txt</strong> <span id="dropText">drop your file here</span><br/>
              <span class="muted" id="orClick">or click to choose</span>
              <input id="file" type="file" accept=".txt,text/plain" hidden>
            </div>
            <div style="margin-top:10px" class="muted" id="fileInfo"></div>
          </div>

          <div class="panel">
            <label id="outLabel">Output Filename (optional)</label>
            <input type="text" id="outName" placeholder="e.g. my-file">
            <div class="muted" id="outHint">Extension is added automatically (.pdf / .txt)</div>
          </div>
        </div>
      </div>
    </div>

    <footer>Â© <span id="y"></span> Yasmer PDF â€¢ <span id="hosted">Hosted on Vercel</span></footer>
  </div>

<script>
const I18N = {
  en: {
    badge: "Free â€¢ Fast",
    title_txt2pdf: "TXT â†’ PDF",
    title_pdf2txt: "PDF â†’ TXT",
    sub_txt2pdf: "Type/paste text or drop a <b>.txt</b> file in the box on the right.",
    sub_pdf2txt: "Drop a <b>.pdf</b> file in the box on the right; weâ€™ll extract its text.",
    action_txt2pdf: "Create & Download PDF",
    action_pdf2txt: "Extract & Download (.txt)",
    clear: "Clear",
    hint: "In PDF â†’ TXT mode, the extracted text appears here and downloads as .txt.",
    modeLabel: "Conversion Mode",
    uploadLabel: "Upload (Drag & Drop)",
    dropText: "drop your file here",
    orClick: "or click to choose",
    accept_txt: ".txt",
    accept_pdf: ".pdf",
    outLabel: "Output Filename (optional)",
    outHint: "Extension is added automatically (.pdf / .txt)",
    hosted: "Hosted on Vercel",
    ph_txt: "Type your text here...",
    alerts: {
      txtOnly: "Please upload a .txt file.",
      pdfOnly: "Please upload a .pdf file.",
      emptyText: "Text is empty.",
      serverError: "Server error",
      extractFail: "Failed to extract text",
      tooBig: "File is too large (â‰¤ 4 MB recommended)."
    }
  },
  tr: {
    badge: "Ãœcretsiz â€¢ HÄ±zlÄ±",
    title_txt2pdf: "TXT â†’ PDF",
    title_pdf2txt: "PDF â†’ TXT",
    sub_txt2pdf: "Metni yaz / yapÄ±ÅŸtÄ±r ya da saÄŸdaki kutuya <b>.txt</b> dosyasÄ± bÄ±rak.",
    sub_pdf2txt: "SaÄŸdaki kutuya <b>.pdf</b> dosyasÄ±nÄ± bÄ±rak; metnini Ã§Ä±karalÄ±m.",
    action_txt2pdf: "PDF OluÅŸtur ve Ä°ndir",
    action_pdf2txt: "Metni Ã‡Ä±kar ve Ä°ndir (.txt)",
    clear: "Temizle",
    hint: "PDF â†’ TXT modunda yÃ¼klediÄŸin PDFâ€™in metnini burada gÃ¶rebilir ve .txt olarak indirebilirsin.",
    modeLabel: "DÃ¶nÃ¼ÅŸtÃ¼rme Modu",
    uploadLabel: "Dosya YÃ¼kle (SÃ¼rÃ¼kle & BÄ±rak)",
    dropText: "dosyanÄ± buraya bÄ±rak",
    orClick: "veya tÄ±kla seÃ§",
    accept_txt: ".txt",
    accept_pdf: ".pdf",
    outLabel: "Ã‡Ä±ktÄ± Dosya AdÄ± (opsiyonel)",
    outHint: "UzantÄ± otomatik eklenir (.pdf / .txt)",
    hosted: "Vercel Ã¼zerinde barÄ±ndÄ±rÄ±lÄ±yor",
    ph_txt: "Metni buraya yaz...",
    alerts: {
      txtOnly: "LÃ¼tfen .txt dosyasÄ± yÃ¼kleyin.",
      pdfOnly: "LÃ¼tfen .pdf dosyasÄ± yÃ¼kleyin.",
      emptyText: "Metin boÅŸ.",
      serverError: "Sunucu hatasÄ±",
      extractFail: "Metin Ã§Ä±karÄ±lamadÄ±",
      tooBig: "Dosya Ã§ok bÃ¼yÃ¼k (â‰¤ 4 MB Ã¶nerilir)."
    }
  }
};

let lang = "en"; // default English
const $ = (id)=>document.getElementById(id);
const flagEn = $("flag-en"), flagTr = $("flag-tr");

flagEn.addEventListener('click', ()=>setLang("en"));
flagTr.addEventListener('click', ()=>setLang("tr"));

function setLang(l){
  lang = l;
  flagEn.classList.toggle("active", l==="en");
  flagTr.classList.toggle("active", l==="tr");
  applyI18N();
}

/* Elements */
const form = $("f"), txt = $("text"), clearBtn = $("clearBtn"),
      drop = $("drop"), fileInput = $("file"), fileInfo = $("fileInfo"),
      modeSel = $("mode"), titleEl = $("title"), subtitle = $("subtitle"),
      acceptLabel = $("acceptLabel"), outName = $("outName"),
      actionBtn = $("actionBtn"), hint = $("hint"),
      modeLabel = $("modeLabel"), uploadLabel = $("uploadLabel"),
      dropText = $("dropText"), orClick = $("orClick"),
      outLabel = $("outLabel"), outHint = $("outHint"), hosted = $("hosted");

document.getElementById('y').textContent = new Date().getFullYear();
let mode = 'txt2pdf';

function applyI18N(){
  const T = I18N[lang];
  hint.textContent = T.hint;
  modeLabel.textContent = T.modeLabel;
  uploadLabel.textContent = T.uploadLabel;
  dropText.textContent = T.dropText;
  orClick.textContent = T.orClick;
  outLabel.textContent = T.outLabel;
  outHint.textContent = T.outHint;
  hosted.textContent = T.hosted;

  if (mode === 'txt2pdf') {
    titleEl.textContent = T.title_txt2pdf;
    subtitle.innerHTML = T.sub_txt2pdf;
    acceptLabel.textContent = T.accept_txt;
    fileInput.accept = '.txt,text/plain';
    actionBtn.textContent = T.action_txt2pdf;
    txt.placeholder = T.ph_txt;
  } else {
    titleEl.textContent = T.title_pdf2txt;
    subtitle.innerHTML = T.sub_pdf2txt;
    acceptLabel.textContent = T.accept_pdf;
    fileInput.accept = '.pdf,application/pdf';
    actionBtn.textContent = T.action_pdf2txt;
    txt.placeholder = (lang==="en"?"Extracted text will appear here...":"Ã‡Ä±karÄ±lan metin burada gÃ¶rÃ¼necek...");
  }
  clearBtn.textContent = T.clear;
}
applyI18N();

/* Mode switch */
modeSel.addEventListener('change', ()=>{
  mode = modeSel.value;
  txt.value = '';
  fileInfo.textContent = '';
  outName.value = '';
  applyI18N();
});

/* Form submit */
form.addEventListener('submit', async e=>{
  e.preventDefault();
  const base = (outName.value || (mode === 'txt2pdf' ? 'text' : 'extracted')).trim();
  if (mode === 'txt2pdf') {
    await createPdf(txt.value, base);
  } else if (!txt.value.trim()) {
    alert(I18N[lang].alerts.emptyText);
  }
});

/* Clear */
clearBtn.addEventListener('click', ()=>{
  txt.value = '';
  fileInfo.textContent = '';
  outName.value = '';
});

/* Drag & drop */
drop.addEventListener('click', ()=> fileInput.click());
['dragenter','dragover'].forEach(ev => drop.addEventListener(ev, e=>{
  e.preventDefault(); e.stopPropagation(); drop.classList.add('drag');
}));
['dragleave','drop'].forEach(ev => drop.addEventListener(ev, e=>{
  e.preventDefault(); e.stopPropagation(); drop.classList.remove('drag');
}));

drop.addEventListener('drop', e=>{
  const file = e.dataTransfer.files?.[0];
  if (file) handleFile(file);
});
fileInput.addEventListener('change', ()=>{
  const file = fileInput.files?.[0];
  if (file) handleFile(file);
});

function handleFile(file){
  const T = I18N[lang].alerts;
  if (file.size > 4 * 1024 * 1024) return alert(T.tooBig);

  if (mode === 'txt2pdf') {
    if (!/\.txt$/i.test(file.name)) return alert(T.txtOnly);
    const reader = new FileReader();
    reader.onload = ()=>{
      txt.value = reader.result;
      const base = (outName.value || file.name.replace(/\.txt$/i,'') || 'text');
      fileInfo.textContent = `â†’ ${base}.pdf`;
      createPdf(txt.value, base);
    };
    reader.readAsText(file);
  } else {
    if (!/\.pdf$/i.test(file.name)) return alert(T.pdfOnly);
    const base = (outName.value || file.name.replace(/\.pdf$/i,'') || 'extracted');
    fileInfo.textContent = `â†’ ${base}.txt`;
    extractTextFromPdf(file, base);
  }
}

async function createPdf(text, baseName){
  const T = I18N[lang].alerts;
  if (!text.trim()) return alert(T.emptyText);
  actionBtn.disabled = true; actionBtn.textContent = lang==="en"?"Creating...":"OluÅŸturuluyor...";
  try{
    const res = await fetch('/api/make-pdf', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ text, filename: baseName + '.pdf' })
    });
    if(!res.ok){
      let msg = T.serverError;
      try { const j = await res.json(); msg = j.error || msg; } catch {}
      throw new Error(msg);
    }
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = baseName + '.pdf'; a.click();
    URL.revokeObjectURL(url);
  }catch(err){ alert('PDF: '+err.message); }
  finally{ actionBtn.disabled = false; applyI18N(); }
}

async function extractTextFromPdf(file, baseName){
  const T = I18N[lang].alerts;
  actionBtn.disabled = true; actionBtn.textContent = lang==="en"?"Extracting...":"Ã‡Ä±karÄ±lÄ±yor...";
  try{
    const arrayBuf = await file.arrayBuffer();
    const res = await fetch('/api/pdf-to-txt', {
      method:'POST',
      headers:{ 'Content-Type': 'application/pdf' },
      body: arrayBuf
    });
    if(!res.ok){
      let msg = T.serverError;
      try { const j = await res.json(); msg = j.error || msg; } catch {}
      throw new Error(msg);
    }
    const textRes = await res.text();
    txt.value = textRes;
    const blob = new Blob([textRes], {type:'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = baseName + '.txt'; a.click();
    URL.revokeObjectURL(url);
  }catch(err){
    alert(I18N[lang].alerts.extractFail + ': ' + err.message);
  }finally{
    actionBtn.disabled = false; applyI18N();
  }
}
</script>
</body>
</html>
